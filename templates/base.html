<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Pharmacogenomics Analysis{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="shortcut icon" href="../static/image.png" type="image/x-icon">
    {% block extra_css %}{% endblock %}
</head>

<body>
    {% block body_start %}{% endblock %}

    <div class="container">
        {% block navbar %}
        <nav class="navbar">
            <a href="{{ url_for('landing') }}" class="navbar-brand">Pharmacogenomics Analysis</a>
            <div class="navbar-links">
                <a href="{{ url_for('dashboard') }}">Dashboard</a>
                <a href="{{ url_for('history') }}">History</a>
                <a href="{{ url_for('logout') }}" class="logout">Logout</a>
                <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">
                    <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="#f39c12" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    <svg class="moon-icon" style="display:none" viewBox="0 0 24 24" fill="none" stroke="var(--accent)"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
            </div>
        </nav>
        {% endblock %}

        {% if current_user.is_authenticated and current_user.role == 'researcher' %}
        <div class="research-banner">
            <p><strong>Research Use Only</strong> â€” This analysis is for research purposes. Not for clinical
                decision-making.</p>
        </div>
        {% endif %}

        {% block content %}{% endblock %}
    </div>

    {% block footer %}{% endblock %}

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            if (newTheme === 'dark') {
                html.setAttribute('data-theme', 'dark');
            } else {
                html.removeAttribute('data-theme');
            }

            localStorage.setItem('theme', newTheme);
            updateThemeToggleUI(newTheme);
        }

        function updateThemeToggleUI(theme) {
            const toggle = document.getElementById('themeToggle');
            if (!toggle) return;

            const sunIcon = toggle.querySelector('.sun-icon');
            const moonIcon = toggle.querySelector('.moon-icon');

            if (theme === 'dark') {
                sunIcon.style.display = 'none';
                moonIcon.style.display = 'block';
            } else {
                sunIcon.style.display = 'block';
                moonIcon.style.display = 'none';
            }
        }

        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            } else {
                document.documentElement.removeAttribute('data-theme');
            }
            updateThemeToggleUI(savedTheme);
        }

        initTheme();
    </script>

    {% block extra_js %}{% endblock %}
</body>

</html>